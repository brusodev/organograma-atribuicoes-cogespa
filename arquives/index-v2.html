<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organograma Interativo - SEDUC</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #e8e8e8 0%, #f5f5f5 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      border-top: 6px solid #c41e3a;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, #c41e3a 0%, #8b0000 100%);
      border-radius: 10px;
      color: white;
      margin: -20px -20px 30px -20px;
    }

    .header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      color: white;
    }

    .header p {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.1rem;
      font-weight: 500;
    }

    .gov-badge {
      display: inline-block;
      background: white;
      color: #c41e3a;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-top: 10px;
    }

    #organogram {
      width: 100%;
      height: 700px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      overflow: auto;
    }

    .node-rect {
      cursor: pointer;
      transition: all 0.3s ease;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
    }

    .node-rect:hover {
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.2));
      transform: scale(1.05);
    }

    .node-text {
      font-size: 13px;
      font-weight: 600;
      text-anchor: middle;
      dominant-baseline: middle;
      pointer-events: none;
    }

    .link {
      fill: none;
      stroke: #c41e3a;
      stroke-width: 3;
      stroke-opacity: 0.8;
    }

    .info-icon {
      cursor: pointer;
      transition: all 0.3s ease;
      pointer-events: all;
    }

    .info-icon:hover {
      transform: scale(1.2);
    }

    .info-text {
      pointer-events: none;
      user-select: none;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: white;
      margin: 5% auto;
      padding: 0;
      border-radius: 20px;
      width: 90%;
      max-width: 900px;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      background: linear-gradient(135deg, #c41e3a, #8b0000);
      color: white;
      padding: 25px;
      position: relative;
    }

    .modal-header h2 {
      margin: 0;
      font-size: 1.8rem;
      font-weight: 600;
    }

    .close {
      position: absolute;
      right: 25px;
      top: 25px;
      color: white;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 0;
      max-height: 65vh;
      overflow: hidden;
    }

    /* Sistema de Abas */
    .tabs-container {
      border-bottom: 2px solid #f0f0f0;
    }

    .tabs {
      display: flex;
      background: #f8f9fa;
      margin: 0;
      padding: 0;
    }

    .tab {
      flex: 1;
      padding: 15px 20px;
      background: #f8f9fa;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: #666;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
    }

    .tab:first-child {
      border-radius: 0;
    }

    .tab:last-child {
      border-radius: 0;
    }

    .tab.active {
      background: white;
      color: #c41e3a;
      border-bottom-color: #c41e3a;
    }

    .tab:hover:not(.active) {
      background: #e9ecef;
      color: #495057;
    }

    .tab-content {
      display: none;
      padding: 30px;
      max-height: 55vh;
      overflow-y: auto;
    }

    .tab-content.active {
      display: block;
    }

    .tab-content h3 {
      color: #c41e3a;
      margin-bottom: 20px;
      font-size: 1.2rem;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }

    /* Estilo para artigos detalhados */
    .article-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #c41e3a;
    }

    .article-section-full {
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #c41e3a;
    }

    .article-section-full h4 {
      color: #c41e3a;
      font-size: 1.1rem;
      margin: 20px 0 10px 0;
      font-weight: bold;
    }

    .article-section-full p {
      margin: 15px 0;
      line-height: 1.6;
    }

    .article-title {
      font-weight: bold;
      color: #c41e3a;
      font-size: 1.1rem;
      margin-bottom: 15px;
    }

    .article-content {
      line-height: 1.6;
      color: #444;
    }

    .article-item {
      margin-bottom: 12px;
      padding-left: 20px;
      position: relative;
      line-height: 1.6;
    }

    .article-item:before {
      content: "‚ñ™";
      color: #c41e3a;
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    .coming-soon {
      text-align: center;
      padding: 40px 20px;
      color: #888;
      font-style: italic;
    }

    .coming-soon .icon {
      font-size: 3rem;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    .competencia {
      background: #f8f9fa;
      border-left: 4px solid #c41e3a;
      padding: 15px 20px;
      margin: 15px 0;
      border-radius: 0 10px 10px 0;
      transition: all 0.3s ease;
    }

    .competencia:hover {
      background: #f0f0f0;
      transform: translateX(5px);
    }

    .competencia-number {
      color: #c41e3a;
      font-weight: bold;
      display: inline-block;
      min-width: 25px;
    }

    .reference {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      font-size: 0.9rem;
      color: #666;
      border: 1px solid #e9ecef;
    }

    /* Responsividade */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .container {
        padding: 20px;
      }

      .header h1 {
        font-size: 1.8rem;
      }

      .header p {
        font-size: 1rem;
      }

      #organogram {
        height: 600px;
      }

      .modal-content {
        width: 95%;
        margin: 10% auto;
        max-height: 90vh;
      }

      .modal-header {
        padding: 20px;
      }

      .modal-header h2 {
        font-size: 1.4rem;
        padding-right: 50px;
      }

      .modal-body {
        padding: 20px;
        max-height: 70vh;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.5rem;
      }

      #organogram {
        height: 500px;
      }

      .modal-content {
        margin: 5% auto;
        max-height: 95vh;
      }

      .modal-header h2 {
        font-size: 1.2rem;
      }

      .competencia {
        padding: 12px 15px;
        margin: 10px 0;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>Organograma Interativo</h1>
      <p>Clique nos bot√µes para visualizar as compet√™ncias de cada unidade</p>
      <div class="gov-badge">üèõÔ∏è Governo do Estado de S√£o Paulo</div>
    </div>

    <div id="organogram"></div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-title"></h2>
        <span class="close" onclick="closeModal()">&times;</span>
      </div>
      <div class="modal-body">
        <div id="modal-content"></div>
      </div>
    </div>
  </div>

  <script>
    // Dados da estrutura hier√°rquica com siglas oficiais
    const data = {
      name: "Coordenadoria Geral de Suporte Administrativo (COGESPA)",
      id: "main",
      children: [
        {
          name: "Coordenadoria de Execu√ß√£o de Servi√ßo (COEX)",
          id: "execucao",
          children: [
            {
              name: "Departamento de Gest√£o Documental (DPGDOC)",
              id: "gestao"
            },
            {
              name: "Divis√£o de Patrim√¥nio (DPAT)",
              id: "patrimonio"
            },
            {
              name: "Divis√£o de Transportes (DTRAN)",
              id: "transportes"
            },
            {
              name: "Divis√£o de Zeladoria (DZEL)",
              id: "zeladoria"
            }
          ]
        },
        {
          name: "Coordenadoria de Programa√ß√£o de Servi√ßo (COPROG)",
          id: "programacao"
        }
      ]
    };

    // Fun√ß√£o para verificar se √© dispositivo m√≥vel
    function isMobile() {
      return window.innerWidth <= 768;
    }

    // Configura√ß√µes responsivas
    function getResponsiveConfig() {
      const isMobileDevice = isMobile();
      return {
        margin: isMobileDevice ? { top: 30, right: 20, bottom: 30, left: 20 } : { top: 50, right: 50, bottom: 50, left: 50 },
        width: isMobileDevice ? Math.max(800, window.innerWidth * 1.5) : 1400,
        height: isMobileDevice ? 500 : 600,
        nodeSpacing: isMobileDevice ? 1.5 : 3
      };
    }

    function createOrganogram() {
      // Limpar SVG existente
      d3.select("#organogram").selectAll("*").remove();

      const config = getResponsiveConfig();
      const { margin, width, height, nodeSpacing } = config;

      // Criar SVG
      const svg = d3.select("#organogram")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);

      const g = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

      // Criar √°rvore hier√°rquica
      const tree = d3.tree()
        .size([width, height - 100])
        .separation((a, b) => {
          return a.parent === b.parent ? nodeSpacing : nodeSpacing + 1;
        });

      const root = d3.hierarchy(data);
      tree(root);

      // Ajustar posicionamento manual para melhor layout com mais espa√ßamento
      root.x = width / 2;
      root.y = 80;

      if (root.children) {
        root.children[0].x = width * 0.25;
        root.children[0].y = 250;
        root.children[1].x = width * 0.75;
        root.children[1].y = 250;

        // Posicionar filhos da Coordenadoria de Execu√ß√£o com mais espa√ßamento
        if (root.children[0].children) {
          const execChildren = root.children[0].children;
          const totalWidth = width * 0.8;
          const spacing = totalWidth / (execChildren.length + 1);
          const startX = width * 0.1;

          execChildren.forEach((child, i) => {
            child.x = startX + (i + 1) * spacing;
            child.y = 450;
          });
        }
      }

      // Definir gradientes com cores oficiais do Governo de SP
      const defs = svg.append("defs");

      // Gradiente principal - Vermelho oficial SP
      const gradientMain = defs.append("linearGradient")
        .attr("id", "gradientMain")
        .attr("x1", "0%").attr("y1", "0%")
        .attr("x2", "100%").attr("y2", "100%");
      gradientMain.append("stop").attr("offset", "0%").style("stop-color", "#c41e3a");
      gradientMain.append("stop").attr("offset", "100%").style("stop-color", "#8b0000");

      // Gradiente coordenadorias - Preto e cinza
      const gradientCoord = defs.append("linearGradient")
        .attr("id", "gradientCoord")
        .attr("x1", "0%").attr("y1", "0%")
        .attr("x2", "100%").attr("y2", "100%");
      gradientCoord.append("stop").attr("offset", "0%").style("stop-color", "#2c2c2c");
      gradientCoord.append("stop").attr("offset", "100%").style("stop-color", "#4a4a4a");

      // Gradiente departamento - Vermelho mais claro
      const gradientDept = defs.append("linearGradient")
        .attr("id", "gradientDept")
        .attr("x1", "0%").attr("y1", "0%")
        .attr("x2", "100%").attr("y2", "100%");
      gradientDept.append("stop").attr("offset", "0%").style("stop-color", "#e53e3e");
      gradientDept.append("stop").attr("offset", "100%").style("stop-color", "#c41e3a");

      // Gradiente divis√µes - Cinza claro
      const gradientDiv = defs.append("linearGradient")
        .attr("id", "gradientDiv")
        .attr("x1", "0%").attr("y1", "0%")
        .attr("x2", "100%").attr("y2", "100%");
      gradientDiv.append("stop").attr("offset", "0%").style("stop-color", "#f7f7f7");
      gradientDiv.append("stop").attr("offset", "100%").style("stop-color", "#e2e2e2");

      // Desenhar links (conex√µes)
      const links = g.selectAll(".link")
        .data(root.links())
        .enter().append("path")
        .attr("class", "link")
        .attr("d", d3.linkVertical()
          .x(d => d.x)
          .y(d => d.y));

      // Fun√ß√£o para determinar cor e tamanho baseado no tipo (cores oficiais SP)
      function getNodeStyle(d) {
        const isMobileDevice = isMobile();
        const scale = isMobileDevice ? 0.8 : 1;

        if (d.depth === 0) {
          return {
            fill: "url(#gradientMain)",
            width: 320 * scale,
            height: 70 * scale,
            textColor: "white",
            stroke: "#8b0000"
          };
        } else if (d.depth === 1) {
          return {
            fill: "url(#gradientCoord)",
            width: 260 * scale,
            height: 60 * scale,
            textColor: "white",
            stroke: "#2c2c2c"
          };
        } else {
          const isDept = d.data.name.includes("Departamento");
          return {
            fill: isDept ? "url(#gradientDept)" : "url(#gradientDiv)",
            width: 200 * scale,
            height: 55 * scale,
            textColor: isDept ? "white" : "#2c2c2c",
            stroke: isDept ? "#c41e3a" : "#999"
          };
        }
      }

      // Criar grupos para os n√≥s
      const node = g.selectAll(".node")
        .data(root.descendants())
        .enter().append("g")
        .attr("class", "node")
        .attr("transform", d => `translate(${d.x},${d.y})`);

      // Adicionar ret√¢ngulos clic√°veis com bordas oficiais
      node.append("rect")
        .attr("class", "node-rect")
        .attr("x", d => -getNodeStyle(d).width / 2)
        .attr("y", d => -getNodeStyle(d).height / 2)
        .attr("width", d => getNodeStyle(d).width)
        .attr("height", d => getNodeStyle(d).height)
        .attr("rx", 12)
        .attr("ry", 12)
        .style("fill", d => getNodeStyle(d).fill)
        .style("stroke", d => getNodeStyle(d).stroke)
        .style("stroke-width", 2)
        .on("click", function (event, d) {
          openModal(d.data.id);
        });

      // Adicionar texto
      node.append("text")
        .attr("class", "node-text")
        .attr("dy", 0)
        .style("fill", d => getNodeStyle(d).textColor)
        .style("font-size", d => {
          const baseSize = d.depth === 0 ? 14 : 12;
          return isMobile() ? baseSize - 1 + "px" : baseSize + "px";
        })
        .each(function (d) {
          const words = d.data.name.split(' ');
          const lineHeight = 1.1;
          const maxWidth = getNodeStyle(d).width - 40;

          let line = [];
          let lineNumber = 0;
          const text = d3.select(this);

          words.forEach(word => {
            line.push(word);
            const testLine = line.join(' ');

            // Estimar largura do texto
            if (testLine.length * 6 > maxWidth && line.length > 1) {
              line.pop();
              text.append("tspan")
                .attr("x", 0)
                .attr("dy", lineNumber === 0 ? -lineHeight * 0.3 + "em" : lineHeight + "em")
                .text(line.join(' '));
              line = [word];
              lineNumber++;
            }
          });

          text.append("tspan")
            .attr("x", 0)
            .attr("dy", lineNumber === 0 ? 0 : lineHeight + "em")
            .text(line.join(' '));
        });

      // Adicionar √≠cone de informa√ß√£o com cores oficiais
      node.append("circle")
        .attr("class", "info-icon")
        .attr("cx", d => getNodeStyle(d).width / 2 - 18)
        .attr("cy", d => -getNodeStyle(d).height / 2 + 18)
        .attr("r", isMobile() ? 8 : 10)
        .style("fill", "#c41e3a")
        .style("stroke", "white")
        .style("stroke-width", 2)
        .on("click", function (event, d) {
          event.stopPropagation();
          openModal(d.data.id);
        });

      node.append("text")
        .attr("class", "info-text")
        .attr("x", d => getNodeStyle(d).width / 2 - 18)
        .attr("y", d => -getNodeStyle(d).height / 2 + 18)
        .attr("text-anchor", "middle")
        .attr("dominant-baseline", "middle")
        .style("fill", "white")
        .style("font-size", isMobile() ? "10px" : "12px")
        .style("font-weight", "bold")
        .text("‚Ñπ");
    }

    // ====== INFORMA√á√ïES DETALHADAS COMPLETAS ======
    const competencias = {
      main: {
        title: "Coordenadoria Geral de Suporte Administrativo",
        summary: [
          "Unidade respons√°vel pela coordena√ß√£o geral de todos os servi√ßos de suporte administrativo da Secretaria de Educa√ß√£o",
          "Supervisiona as atividades das coordenadorias subordinadas",
          "Garante a integra√ß√£o e efici√™ncia dos servi√ßos administrativos",
          "Promove a otimiza√ß√£o de recursos e processos"
        ],
        articles: {
          available: true,
          title: "Coordenadoria Geral de Suporte Administrativo ‚Äì COGESPA",
          sections: [
            {
              title: "Estrutura Organizacional",
              content: [
                "Coordena as atividades da Coordenadoria de Programa√ß√£o de Servi√ßos (COPROG)",
                "Supervisiona a Coordenadoria de Execu√ß√£o de Servi√ßos (COEX)",
                "Gerencia o Departamento de Gest√£o Documental (DPGDOC)",
                "Administra as Divis√µes de Patrim√¥nio, Transportes e Zeladoria"
              ]
            },
            {
              title: "Compet√™ncias Gerais",
              content: [
                "Estabelecer diretrizes para o funcionamento dos √≥rg√£os centrais da Pasta",
                "Coordenar a integra√ß√£o entre as unidades subordinadas",
                "Promover a efici√™ncia dos servi√ßos de apoio administrativo",
                "Garantir o cumprimento das normas e regulamentos da Secretaria"
              ]
            }
          ]
        },
        article: "Conforme estrutura organizacional da SEDUC"
      },
      programacao: {
        title: "Coordenadoria de Programa√ß√£o de Servi√ßo",
        summary: [
          "Elaborar planos, cronogramas e agendas para a contrata√ß√£o e execu√ß√£o de servi√ßos de gest√£o documental, transporte administrativo, zeladoria e patrim√¥nio",
          "Alocar e gerenciar recursos humanos, materiais e financeiros de forma eficiente",
          "Mapear, analisar e otimizar atividades de administra√ß√£o predial",
          "Acompanhar a execu√ß√£o dos planos e programas, avaliando resultados",
          "Gerir os servi√ßos de limpeza das Unidades Regionais de Ensino"
        ],
        articles: {
          available: true,
          title: "Coordenadoria de Programa√ß√£o de Servi√ßos ‚Äì COPROG",
          content: `
                        <p><strong>A COPROG possui as seguintes atribui√ß√µes:</strong></p>
                        
                        <div class="article-item">Fornecer orienta√ß√µes jur√≠dicas ao Departamento e √†s Divis√µes, elaborar justificativas e descrever objetos ou servi√ßos para novas contrata√ß√µes, bem como realizar pesquisas de itens de materiais de consumo ou permanentes para os Pr√©dios Administrativos;</div>
                        
                        <div class="article-item">Acompanhar e fiscalizar a legisla√ß√£o, sindicatos, san√ß√µes e multas; elaborar termos de refer√™ncia, notifica√ß√µes e of√≠cios; analisar a viabilidade de novas contrata√ß√µes; e fornecer orienta√ß√µes para o Sistema de Cadastro de Servi√ßos Terceirizados da Corregedoria, incluindo cadastro de contratos cont√≠nuos a partir da assinatura e, mensalmente, informar pagamentos e reajustes;</div>
                        
                        <h4><strong>Gest√£o da Vida Funcional dos Servidores</strong></h4>
                        
                        <div class="article-item">Gerenciar procedimentos para nomea√ß√£o de novos servidores, orienta√ß√£o e confer√™ncia de documentos, registro de aloca√ß√£o em caso de mudan√ßa de cargo e registro de servidores novos no sistema Secretaria Escolar Digital (SED);</div>
                        
                        <div class="article-item">Controlar frequ√™ncia de servidores, folhas de ponto, assinaturas de entrada e sa√≠da, f√©rias, faltas justificadas e injustificadas, licen√ßas m√©dicas, licen√ßa pr√™mio, afastamentos e demais ocorr√™ncias funcionais;</div>
                        
                        <div class="article-item">Atualizar mensalmente f√©rias no sistema SED;</div>
                        
                        <div class="article-item">Encaminhar atestados m√©dicos e requerimentos de licen√ßa sa√∫de/aux√≠lio-doen√ßa ao Recursos Humanos;</div>
                        
                        <div class="article-item">Elaborar memorandos de substitui√ß√£o e gratifica√ß√£o;</div>
                        
                        <div class="article-item">Revisar mensalmente as folhas de frequ√™ncia e envi√°-las ao RH;</div>
                        
                        <div class="article-item">Realizar reuni√µes semanais com diretores para repassar orienta√ß√µes relativas aos servidores;</div>
                        
                        <div class="article-item">Acompanhar publica√ß√µes no Di√°rio Oficial do Estado (D.O.E.) sobre decretos, licen√ßas, afastamentos e pedidos de aposentadoria, registrando nas folhas de frequ√™ncia.</div>
                        
                        <h4><strong>Contato com √ìrg√£os Fiscalizadores</strong></h4>
                        
                        <div class="article-item"><strong>Sistema de Consolida√ß√£o da Informa√ß√£o ao Tribunal de Contas (SCT):</strong> Alimenta√ß√£o mensal com informa√ß√µes de licita√ß√µes homologadas e contratos vigentes;</div>
                        
                        <div class="article-item"><strong>Sistema de Auditoria Eletr√¥nica do Tribunal de Contas (AUDESP):</strong> Alimenta√ß√£o mensal com informa√ß√µes de licita√ß√µes homologadas e contratos vigentes;</div>
                        
                        <div class="article-item"><strong>Sistema de Contas Estaduais do Tribunal de Contas (SISCOE):</strong> Atualiza√ß√£o anual dos dados cadastrais das autoridades da pasta e envio do relat√≥rio de atividades desenvolvido pelo Gabinete do Secret√°rio e assessorias no ano anterior.</div>
                        
                        <h4><strong>Planejamento Financeiro e Gerenciamento Or√ßament√°rio</strong></h4>
                        
                        <div class="article-item">Gerenciar recursos financeiros da COGESPA e acompanhar os recursos do Gabinete do Secret√°rio;</div>
                        
                        <div class="article-item">Realizar reuni√µes peri√≥dicas com a √°rea financeira, elaborar planilhas financeiras, comunicados, analisar disponibilidade or√ßament√°ria para novas contrata√ß√µes, cancelamentos e remanejamentos;</div>
                        
                        <div class="article-item">Suportar e analisar pagamentos de contratos cont√≠nuos junto aos centros de custo.</div>
                        
                        <h4><strong>Publica√ß√µes no Di√°rio Oficial</strong></h4>
                        
                        <div class="article-item">Receber atos a serem publicados via sistema Sem Papel ou Outlook, preparar laudas e enviar √† PRODESP para publica√ß√£o;</div>
                        
                        <div class="article-item">Realizar confer√™ncia no Di√°rio Oficial no dia seguinte, inserir c√≥pias nos processos e enviar √† √°rea demandante.</div>
                        
                        <h4><strong>Apura√ß√£o Preliminar</strong></h4>
                        
                        <div class="article-item">Participar de apura√ß√µes preliminares para identificar ou confirmar a ocorr√™ncia de il√≠cito administrativo, incluindo an√°lise de processos, oitivas com servidores envolvidos e reuni√µes com demais participantes.</div>
                        
                        <h4><strong>Gest√£o de Contratos Administrativos (37 contratos)</strong></h4>
                        
                        <div class="article-item"><strong>Publicidade Governamental:</strong> Gerenciamento processual, reservas, empenhos, pagamentos e cancelamentos de saldo;</div>
                        
                        <div class="article-item"><strong>Foto, V√≠deo e Filmagem:</strong> Fiscaliza√ß√£o, administra√ß√£o de pagamentos, aditamentos contratuais, reajustes, ordens de servi√ßo e acompanhamento da execu√ß√£o;</div>
                        
                        <div class="article-item"><strong>Certifica√ß√£o Digital:</strong> Autua√ß√£o de processos, pesquisa de mercado, solicita√ß√£o de autoriza√ß√£o junto ao COETIC, reserva, empenho e pagamentos de notas fiscais;</div>
                        
                        <div class="article-item"><strong>Passagens A√©reas:</strong> Pesquisa de voos nacionais e internacionais, emiss√£o de bilhetes, seguro viagem, controle de or√ßamento, cancelamentos, pagamento e informa√ß√£o ao site da transpar√™ncia;</div>
                        
                        <div class="article-item"><strong>Seguro Veicular:</strong> Acompanhamento de franquia, solicita√ß√£o de guincho, pagamento de franquias, reservas, empenhos e pagamentos;</div>
                        
                        <div class="article-item"><strong>Manuten√ß√£o de Servi√ßos:</strong> Reajustes contratuais, execu√ß√£o de aditamentos, verifica√ß√£o da conven√ß√£o coletiva, pagamentos de sal√°rios e benef√≠cios; controle de pagamentos mensais, reservas, empenhos e cancelamentos de saldo.</div>
                        
                        <p>Os servi√ßos gerenciados incluem manuten√ß√£o predial, recep√ß√£o, vigil√¢ncia patrimonial, bombeiros, manobristas, loca√ß√£o de ve√≠culos com e sem condutor, placas de inaugura√ß√£o, controle de pragas, purificadores, abastecimento de combust√≠veis e manuten√ß√£o de ve√≠culos oficiais.</p>
                    `
        },
        article: "Artigo 118"
      },
      execucao: {
        title: "Coordenadoria de Execu√ß√£o de Servi√ßo",
        summary: [
          "Coordenar e supervisionar as atividades do Departamento de Gest√£o Documental e Divis√µes",
          "Planejar, executar e controlar os processos operacionais",
          "Implementar e monitorar indicadores de desempenho",
          "Planejar e executar a manuten√ß√£o preventiva e corretiva",
          "Zelar pela organiza√ß√£o, controle e seguran√ßa dos documentos",
          "Assegurar o cumprimento das normas e regulamentos"
        ],
        articles: {
          available: true,
          title: "Coordenadoria de Execu√ß√£o de Servi√ßos ‚Äì COEX",
          sections: [
            {
              title: "Cria√ß√£o e Fun√ß√£o da COEX",
              content: [
                "Criada na reestrutura√ß√£o de 2025",
                "Prestar suporte t√©cnico especializado aos departamentos e divis√µes",
                "Assegurar condi√ß√µes adequadas para execu√ß√£o das atividades administrativas e operacionais"
              ]
            },
            {
              title: "Suporte T√©cnico e Planejamento",
              content: [
                "Apoiar a elabora√ß√£o, acompanhamento e atualiza√ß√£o do planejamento estrat√©gico, t√°tico e operacional",
                "Realizar reuni√µes peri√≥dicas de alinhamento com cada unidade organizacional",
                "Integrar as √°reas, otimizar recursos e monitorar resultados",
                "Analisar demandas e definir prioridades",
                "Gerir processos e fluxos de trabalho, reduzindo retrabalhos e gargalos",
                "Oferecer apoio metodol√≥gico na implementa√ß√£o de projetos",
                "Monitorar metas e elaborar relat√≥rios de desempenho"
              ]
            },
            {
              title: "Gest√£o de Di√°rias",
              content: [
                "Analisar solicita√ß√µes de di√°rias no Sistema Secretaria Escolar Digital (SED)",
                "Verificar anexos, viagens realizadas e utiliza√ß√£o de ve√≠culos oficiais",
                "Montar processos completos para pagamento, incluindo recibos, publica√ß√µes, notas de empenho",
                "Verificar glosas e autoriza√ß√µes, com envio ao Di√°rio Oficial conforme Decreto n¬∫ 48.292/2003"
              ]
            },
            {
              title: "Gest√£o de Eventos",
              content: [
                "Planejar, organizar e acompanhar eventos institucionais, ap√≥s autoriza√ß√£o da Chefia de Gabinete",
                "Coordenar reuni√µes com √°reas demandantes e empresas respons√°veis pela execu√ß√£o",
                "Solicitar apoio de √≥rg√£os externos, como CET, SABESP e infraestrutura",
                "Gerir hospedagem, alimenta√ß√£o, transporte, execu√ß√£o, controle de itens",
                "Mobilizar servidores de todos os centros do Departamento de Administra√ß√£o para apoio log√≠stico"
              ]
            }
          ]
        },
        article: "Artigo 119"
      },
      gestao: {
        title: "Departamento de Gest√£o Documental",
        summary: [
          "Apoiar o planejamento, normatiza√ß√£o e execu√ß√£o dos servi√ßos de gest√£o documental",
          "Prestar servi√ßos de classifica√ß√£o, organiza√ß√£o e conserva√ß√£o de arquivos",
          "Gerenciar os sistemas de controle processual",
          "Receber, protocolar, classificar, expedir e controlar a distribui√ß√£o de processos",
          "Informar e atualizar a localiza√ß√£o de processos em tr√¢mite",
          "Providenciar vista de processos aos interessados",
          "Organizar servi√ßos de malotes e correspond√™ncia"
        ],
        articles: {
          available: true,
          title: "Departamento de Gest√£o Documental ‚Äì DPGDOC",
          sections: [
            {
              title: "Sistemas de Gest√£o Documental",
              content: [
                "NCPB: Sistema iniciado na d√©cada de 1990, encerrado para cadastro em 2018, ainda vigente para consulta",
                "SPDOC: Finalizado para cadastro de documentos vigentes em 2019",
                "SPSP (S√£o Paulo Sem Papel): Sistema finalizado em 2023, utilizado para consulta",
                "SEI (Sistema Eletr√¥nico de Informa√ß√µes): Sistema vigente, utilizado para tramita√ß√£o e gest√£o de processos eletr√¥nicos"
              ]
            },
            {
              title: "Suporte e Orienta√ß√£o",
              content: [
                "Orienta√ß√£o √†s 91 Diretorias de Ensino e √≥rg√£os centrais quanto √† aplica√ß√£o da gest√£o documental",
                "Atendimento √†s normas e procedimentos de protocolo, conforme Manual de Normas e Procedimentos",
                "Interlocu√ß√£o com o Servi√ßo de Informa√ß√£o ao Cidad√£o (SIC) do Departamento de Administra√ß√£o",
                "Execu√ß√£o das atividades da Comiss√£o de Avalia√ß√£o de Documentos e Acesso (CADA)",
                "Orienta√ß√£o por e-mail, telefone, WhatsApp e visitas presenciais"
              ]
            },
            {
              title: "Grupo de Trabalho Protocolo e Malote ‚Äì SEDE",
              content: [
                "Receber, protocolar, cadastrar e encaminhar expedientes e processos da Secretaria",
                "Pesquisar documentos e acompanhar andamento de processos disciplinares",
                "Conferir p√°ginas de processos recebidos de outras secretarias e procuradorias",
                "Separar, organizar e viabilizar servi√ßos de malotes entre √≥rg√£os centrais e 91 Diretorias",
                "Gerenciar quantitativo de 1.630 sacolas de malote entre entrada e sa√≠da"
              ]
            },
            {
              title: "Grupo de Trabalho Arquivo ‚Äì Pr√©dio Arm√™nia",
              content: [
                "Arquivamento e desarquivamento de processos f√≠sicos",
                "Organiza√ß√£o e classifica√ß√£o de documentos arquivados",
                "Triagem de documentos com prazo de guarda cumprido",
                "Cust√≥dia do legado documental de unidades extintas (CEI, COGSP, CENP, DSE)"
              ]
            }
          ]
        },
        article: "Artigo 120"
      },
      patrimonio: {
        title: "Divis√£o de Patrim√¥nio",
        summary: [
          "Acompanhar a deprecia√ß√£o de bens patrimoniais da Secretaria",
          "Administrar e controlar bens patrimoniais",
          "Providenciar seguro de bens patrimoniais m√≥veis e im√≥veis",
          "Efetuar o arrolamento de bens inserv√≠veis",
          "Orientar as demais √°reas na gest√£o de bens patrimoniais",
          "Apoiar na regulariza√ß√£o documental dos im√≥veis",
          "Fiscalizar e orientar a atualiza√ß√£o do SGI",
          "Gerir o controle de materiais"
        ],
        articles: {
          available: true,
          title: "Divis√£o de Patrim√¥nio e Almoxarifado ‚Äì DPAT",
          sections: [
            {
              title: "Gest√£o de Im√≥veis ‚Äì Sistema SGI",
              content: [
                "Respons√°vel por 7.592 im√≥veis no Estado de S√£o Paulo, distribu√≠dos entre 9 departamentos e 91 Diretorias",
                "Analisar e tramitar processos relacionados √† regulariza√ß√£o de im√≥veis",
                "Encaminhar processos √†s √°reas competentes (FDE, DIISE, DGREM e Unidades Regionais)",
                "Autuar processos do PAINSP e receber terrenos doados pelas prefeituras",
                "Capacitar as Diretorias de Ensino sobre o SGI e a import√¢ncia da regulariza√ß√£o fundi√°ria",
                "Elaborar manuais e guias de procedimentos, atendendo aos decretos n¬∫ 61.163/2015 e 64.030/2018"
              ]
            },
            {
              title: "Gest√£o de Bens M√≥veis ‚Äì Sistema GEMAT",
              content: [
                "Gest√£o e atualiza√ß√£o de dados de bens m√≥veis das Diretorias, Unidades Escolares e Pr√©dios Administrativos",
                "Inclus√£o, altera√ß√£o e inativa√ß√£o de perfis de usu√°rios respons√°veis pelo sistema",
                "Orienta√ß√£o √†s Diretorias sobre descarte de materiais inserv√≠veis/excedentes",
                "Invent√°rio f√≠sico de todos os bens permanentes da COGESPA e unidades correlatas",
                "Disponibiliza√ß√£o e armazenamento de mobili√°rio nos dep√≥sitos da Casa Verde e S√£o Domingos",
                "Gest√£o de passagem de √¥nibus via GEMAT √†s Diretorias de Ensino",
                "Implanta√ß√£o do sistema SAM Patrim√¥nio para substituir o GEMAT"
              ]
            },
            {
              title: "Atualiza√ß√£o e Controle de Dados",
              content: [
                "Gest√£o e atualiza√ß√£o cadastral de im√≥veis no SGI",
                "Orienta√ß√£o para abertura de processos de unidades escolarizadas municipalmente",
                "Preenchimento de minutas de termos e escrituras",
                "Tratativas com CDHU e COHAB para regulariza√ß√£o fundi√°ria via comodato",
                "Responsabilidade pela renova√ß√£o dos AVCBs dos pr√©dios administrativos"
              ]
            }
          ]
        },
        article: "Artigo 122"
      },
      transportes: {
        title: "Divis√£o de Transportes",
        summary: [
          "Atender as 91 Diretorias de Ensino com suporte integral",
          "Gerenciar procedimentos relacionados aos ve√≠culos oficiais e locados",
          "Controlar manuten√ß√£o, abastecimento e controle de tr√°fego",
          "Fiscalizar documenta√ß√£o de ve√≠culos cedidos",
          "Propor especifica√ß√µes para contrata√ß√µes e aquisi√ß√µes",
          "Planejar o custo e uso da frota",
          "Regularizar documenta√ß√£o de ve√≠culos",
          "Instruir processos de doa√ß√£o de ve√≠culos"
        ],
        articles: {
          available: true,
          title: "Divis√£o de Transportes ‚Äì DTRAN",
          sections: [
            {
              title: "Gest√£o de Frota",
              content: [
                "Controle de cota anual: 5.000 litros de gasolina, 53.000 litros de diesel e 335.000 litros de etanol",
                "Fiscaliza√ß√£o e cobran√ßa de documenta√ß√£o de 645 munic√≠pios com mais de 4.000 √¥nibus cedidos",
                "Identifica√ß√£o e encaminhamento de infra√ß√µes (multas) de ve√≠culos pr√≥prios e de terceiros",
                "Lan√ßamento de controle de tr√°fego no SAF, conforme Decreto n¬∫ 979/1973",
                "Capacita√ß√£o das 91 Diretorias para uso dos sistemas SAF e SIGEF"
              ]
            },
            {
              title: "Frota Atual",
              content: [
                "23 ve√≠culos pr√≥prios (carros, vans, caminh√µes e √¥nibus)",
                "48 ve√≠culos locados com condutores da empresa DeivisonTur",
                "63 ve√≠culos locados sem condutor, da empresa Bariri, atendendo dois lotes no interior",
                "Controle de condutores autorizados, motoristas locados e agendamento de sa√≠das",
                "Recebimento de requisi√ß√µes de transporte e an√°lise da disponibilidade da frota"
              ]
            },
            {
              title: "Documenta√ß√£o e Licenciamentos",
              content: [
                "Controle e emiss√£o de documentos de ve√≠culos cedidos a munic√≠pios e APAEs",
                "Emiss√£o di√°ria de licenciamentos digitais (aproximadamente 800 ve√≠culos/m√™s)",
                "Emiss√£o de termos de cess√£o de uso e rescis√£o",
                "Entrega de micro√¥nibus aos munic√≠pios, coleta de assinaturas e documenta√ß√£o",
                "Providenciar registros de ve√≠culos 0 km junto ao Detran"
              ]
            },
            {
              title: "Isen√ß√£o de Ped√°gio e DPVAT",
              content: [
                "Solicita√ß√£o de cart√µes de isen√ß√£o para ve√≠culos oficiais em rodovias estaduais e federais",
                "Prepara√ß√£o e pagamento das guias do seguro DPVAT",
                "Autoriza√ß√£o para servidores conduzirem ve√≠culos oficiais da SEDUC via SEI"
              ]
            }
          ]
        },
        article: "Artigo 123"
      },
      zeladoria: {
        title: "Divis√£o de Zeladoria",
        summary: [
          "Executar e organizar eventos internos e externos",
          "Zelar pela organiza√ß√£o e manuten√ß√£o dos pr√©dios administrativos",
          "Gerenciar e fiscalizar servi√ßos preventivos e corretivos",
          "Propor especifica√ß√µes de materiais e equipamentos",
          "Propor especifica√ß√µes para contrata√ß√£o de servi√ßos terceirizados"
        ],
        articles: {
          available: true,
          title: "Divis√£o de Zeladoria ‚Äì DZEL",
          sections: [
            {
              title: "Gest√£o e Fiscaliza√ß√£o Predial",
              content: [
                "Acompanhar empresas terceirizadas na execu√ß√£o dos servi√ßos nos Pr√©dios Administrativos",
                "Verificar diariamente o funcionamento de elevadores, sistemas de ilumina√ß√£o, telefonia",
                "Supervisionar monitoramento de seguran√ßa (c√¢meras), seguran√ßa patrimonial",
                "Fiscalizar instala√ß√µes el√©tricas e hidr√°ulicas, manuten√ß√£o preventiva e corretiva",
                "Comunicar irregularidades √†s empresas prestadoras de servi√ßos",
                "Respons√°vel pela renova√ß√£o de AVCBs e manuten√ß√£o de equipamentos de seguran√ßa contra inc√™ndio"
              ]
            },
            {
              title: "Gest√£o de Eventos e Log√≠stica",
              content: [
                "Montagem, desmontagem e opera√ß√£o de equipamentos de √°udio, v√≠deo e som em eventos",
                "Transporte de materiais de consumo entre os pr√©dios administrativos",
                "Supervis√£o e execu√ß√£o de contratos administrativos de manuten√ß√£o predial",
                "Acompanhamento de execu√ß√£o contratual, pagamentos, reajustes e aditamentos"
              ]
            },
            {
              title: "Servi√ßos Espec√≠ficos",
              content: [
                "Recep√ß√£o: identifica√ß√£o, controle de acesso e direcionamento de visitantes",
                "Vigil√¢ncia patrimonial: prote√ß√£o preventiva do patrim√¥nio e pessoas",
                "Elevadores: verifica√ß√£o de funcionamento, manuten√ß√£o, reajustes",
                "Bombeiro: fiscaliza√ß√£o do posto, equipamentos e rondas",
                "Manobristas: controle de garagem, folhas de ponto e uniforme",
                "Controle de pragas: fiscaliza√ß√£o de servi√ßos de desratiza√ß√£o e desinsetiza√ß√£o",
                "Vigil√¢ncia Eletr√¥nica: gest√£o de cart√µes de acesso, monitoramento de imagens",
                "Telefonia m√≥vel pessoal: distribui√ß√£o, configura√ß√£o e manuten√ß√£o de aparelhos"
              ]
            }
          ]
        },
        article: "Artigo 121"
      }
    };

    function openModal(type) {
      const modal = document.getElementById('modal');
      const modalTitle = document.getElementById('modal-title');
      const modalContent = document.getElementById('modal-content');

      const data = competencias[type];

      modalTitle.textContent = data.title;

      // Criar estrutura com abas
      let contentHTML = `
                <div class="tabs-container">
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab(event, 'summary')">
                            üìã Resumo Executivo
                        </button>
                        <button class="tab" onclick="switchTab(event, 'articles')">
                            üìñ Artigos Detalhados
                        </button>
                    </div>
                </div>
                
                <div id="summary" class="tab-content active">
                    <h3>Compet√™ncias Principais</h3>
            `;

      // Aba 1: Resumo (compet√™ncias atuais)
      data.summary.forEach((competencia, index) => {
        contentHTML += `
                    <div class="competencia">
                        <span class="competencia-number">${index + 1}.</span>
                        ${competencia}
                    </div>
                `;
      });

      contentHTML += `
                    <div class="reference">
                        <strong>Base Legal:</strong> ${data.article}<br>
                        <strong>Fonte:</strong> Resolu√ß√£o SEDUC-SP n¬∫ 108, de 28 de julho de 2025
                    </div>
                </div>
                
                <div id="articles" class="tab-content">
            `;

      // Aba 2: Artigos Detalhados
      if (data.articles && data.articles.available) {
        // Usar o t√≠tulo espec√≠fico da unidade se dispon√≠vel
        const articleTitle = data.articles.title || data.title;
        contentHTML += `<h3>${articleTitle}</h3>`;

        // Verificar se h√° conte√∫do direto (novo formato) ou se√ß√µes (formato antigo)
        if (data.articles.content) {
          // Novo formato: conte√∫do HTML direto
          contentHTML += `<div class="article-section-full">${data.articles.content}</div>`;
        } else if (data.articles.sections) {
          // Formato antigo: se√ß√µes organizadas
          data.articles.sections.forEach(section => {
            contentHTML += `
                            <div class="article-section">
                                <div class="article-title">${section.title}</div>
                                <div class="article-content">
                        `;

            if (Array.isArray(section.content)) {
              section.content.forEach(item => {
                contentHTML += `<div class="article-item">${item}</div>`;
              });
            } else {
              contentHTML += `<div class="article-item">${section.content}</div>`;
            }

            contentHTML += `
                                </div>
                            </div>
                        `;
          });
        }
      } else {
        contentHTML += `
                    <div class="coming-soon">
                        <div class="icon">üìÑ</div>
                        <h3>Artigos Detalhados</h3>
                        <p>As informa√ß√µes detalhadas dos artigos e subse√ß√µes<br>
                        ser√£o adicionadas em breve.</p>
                        <br>
                        <p><strong>Base Legal:</strong> ${data.article}</p>
                    </div>
                `;
      }

      contentHTML += '</div>';

      modalContent.innerHTML = contentHTML;
      modal.style.display = 'block';
    }

    function switchTab(event, tabName) {
      // Remover classe active de todas as abas
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');

      tabs.forEach(tab => tab.classList.remove('active'));
      tabContents.forEach(content => content.classList.remove('active'));

      // Adicionar classe active na aba clicada
      event.target.classList.add('active');
      document.getElementById(tabName).classList.add('active');
    }

    function closeModal() {
      const modal = document.getElementById('modal');
      modal.style.display = 'none';
    }

    // Fechar modal clicando fora dele
    window.onclick = function (event) {
      const modal = document.getElementById('modal');
      if (event.target === modal) {
        closeModal();
      }
    }

    // Fechar modal com ESC
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModal();
      }
    });

    // Criar organograma inicial
    createOrganogram();

    // Recriar organograma quando a tela for redimensionada
    window.addEventListener('resize', function () {
      createOrganogram();
    });
  </script>
</body>

</html>